{"id":"d3-item-salvager-6pj","title":"test","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","created_at":"2026-01-13T15:19:18.0862119-05:00","created_by":"czer323","updated_at":"2026-01-13T15:19:18.0862119-05:00"}
{"id":"d3-item-salvager-okk","title":"Fix: local DB corrupted â€” mixed class items in builds; remove \u0026 repopulate builds","description":"Problem: Local development DB contains corrupted build data: different class items are appended into other builds, causing test failures and unreliable imports. Default DB: d3_items.db. Importers found: python -m d3_item_salvager.scripts.import_guides and python -m d3_item_salvager.utility.load_reference_data. Note: Alembic migrations are not present in repo (migration risk).\n\n## Steps to Reproduce\n1. Run python -m d3_item_salvager.scripts.import_guides against local DB (d3_items.db).\n2. Query builds and related items using sqlite3 or a Python session and look for items attached to unexpected builds.\n3. Observe cross-class mixing: items with different class IDs attached to the same build.\n\n## Acceptance Criteria\n- [ ] Backup file created (d3_items.db.bak) and SQL dump saved.\n- [ ] Cleanup + import executed successfully with the recommended script.\n- [ ] Builds table contains only imported builds and no cross-class mixing.\n- [ ] Integration tests pass: pytest tests/integration/test_builds_items.py","design":"Backup DB; validate cleanup on a copy; recommended: drop and recreate schema using SQLModel.metadata.drop_all/create_all via Container engine; alternative: granular DELETEs in FK-safe order. Repopulate using importer scripts and add an automated script to run backup -\u003e cleanup -\u003e import.","acceptance_criteria":"## Acceptance Criteria\n- [ ] Backup file created (d3_items.db.bak) and SQL dump saved.\n- [ ] Cleanup + import executed successfully with the recommended script.\n- [ ] Builds table contains only imported builds and no cross-class mixing.\n- [ ] Integration tests pass: pytest tests/integration/test_builds_items.py","notes":"## Steps to Reproduce\n1. Run python -m d3_item_salvager.scripts.import_guides against local DB (d3_items.db).\n2. Query builds and related items using sqlite3 or a Python session and look for items attached to unexpected builds.\n3. Observe cross-class mixing: items with different class IDs attached to the same build.","status":"open","priority":1,"issue_type":"bug","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-13T15:36:31.5075701-05:00","created_by":"czer323","updated_at":"2026-01-13T15:37:27.114312-05:00","labels":["testing","tooling"]}
{"id":"d3-item-salvager-ply","title":"Add DB migrations (Alembic) and migration workflow","description":"Repository currently lacks Alembic migrations; add Alembic (or compatible migration tool), generate initial migrations from current models, and add CI/automation to ensure schema migrations are applied and tested.","design":"Add Alembic to repo; configure env and alembic.ini to target development DATABASE_URL; autogenerate initial migration from SQLModel metadata; add migration test that creates a fresh DB, runs alembic upgrade head, and verifies expected tables exist; add a reset script and docs.","acceptance_criteria":"- Given the repo; When running alembic upgrade head on a fresh DB; Then the database schema matches the models and bd migrate --inspect shows no pending migrations; CI runs migration tests and the reset script reproduces schema and sample data.","notes":"Related bug: d3-item-salvager-okk; ensure migration work includes docs for local cleanup/repopulation and sample commands: sqlite3 .dump, python -m d3_item_salvager.scripts.import_guides.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-13T15:36:53.3865052-05:00","created_by":"czer323","updated_at":"2026-01-13T15:36:53.3865052-05:00","labels":["tooling"],"dependencies":[{"issue_id":"d3-item-salvager-ply","depends_on_id":"d3-item-salvager-okk","type":"discovered-from","created_at":"2026-01-13T15:36:53.3923617-05:00","created_by":"czer323"}]}
