{"id":"d3-item-salvager-1t2","title":"Add in-memory cache and optimize /items/lookup to use master item list","description":"Avoid querying the DB on every /items/lookup call by loading the master Item list into an in-memory cache on startup or on-demand. Add an admin endpoint to reload the cache when the reference data changes.\n\n## Acceptance Criteria\n\n- Given items are loaded to cache, when /items/lookup is called repeatedly, then DB is not queried on each request and lookup latency is reduced.\n- Given the cache reload endpoint is called, then the cache is refreshed and lookups reflect newly loaded items.","design":"Load items into a thread-safe global cache on startup or lazily on first lookup; add simple metrics for cache hits/misses and an endpoint to reload; preserve API contract.","notes":"Related: d3-item-salvager-bf5, d3-item-salvager-7xk","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-13T22:00:17.6935292-05:00","created_by":"czer323","updated_at":"2026-01-13T22:00:17.6935292-05:00","labels":["ux"],"dependencies":[{"issue_id":"d3-item-salvager-1t2","depends_on_id":"d3-item-salvager-bf5","type":"blocks","created_at":"2026-01-13T22:08:03.1408853-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-30t","title":"Add tests for slot removal and usage chips","description":"Add unit and integration tests validating slot header removal, preserved data-item-slot attribute, per-context usage chips with classes, and that slot-based filtering continues to work. Add a Playwright smoke test asserting chips have expected classes.","design":"Update tests: frontend/tests/unit/test_item_row.py to assert chips/classes and text; update frontend/tests/unit/test_table_behaviors.py or create new tests for header absence; add Playwright test to check chip classes visually.","acceptance_criteria":"Given the test suite runs, When the change is implemented, Then unit and integration tests cover the new behavior: the Slot column is absent, rows retain data-item-slot attribute, and usage chips are rendered with appropriate classes and text.\n\nGiven CI executes, When the tests run, Then CI should pass with the new tests added.","notes":"Link to UI task: d3-item-salvager-9yd","status":"open","priority":2,"issue_type":"task","assignee":"czer3","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-13T21:08:42.1672796-05:00","created_by":"czer323","updated_at":"2026-01-15T04:47:41.2743251-05:00","labels":["testing"],"dependencies":[{"issue_id":"d3-item-salvager-30t","depends_on_id":"d3-item-salvager-9yd","type":"blocks","created_at":"2026-01-15T04:56:05.0954921-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-5bs","title":"Show selected builds for an item (expandable item row)","description":"Allow users to expand an item row to see which of the currently selected builds include that item (build-level, not variant). The expansion shows build title (linked to source), class chips, and an optional usage_count. Only builds the user previously selected should be considered.\n\n## Acceptance Criteria\n\n- Given selected builds are present, When the user expands an item, Then only the selected builds that include that item are listed, each with title, URL, class chips, and usage_count.\n- Given no selected builds are provided, When the user expands an item, Then a friendly message is shown (e.g., 'No selected builds use this item').","design":"Backend: add GET /items/{item_id}/builds?build_ids=... which filters to provided build IDs and returns aggregated class names and usage counts per build. Frontend: add an accessible expand/collapse control per item row that lazy-loads the builds for that item (passing current selected build ids), caches results, and renders build title (link), class chips, and count. Tests: integration test for endpoint, Playwright test for expand behavior and accessibility. Docs: add usage notes and API docs.","status":"closed","priority":4,"issue_type":"epic","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-14T02:40:35.4664231-05:00","created_by":"czer323","updated_at":"2026-01-15T08:58:55.0237517-05:00","closed_at":"2026-01-15T08:58:55.0237517-05:00","close_reason":"Closed","labels":["ux"],"dependencies":[{"issue_id":"d3-item-salvager-5bs","depends_on_id":"d3-item-salvager-ucb","type":"related","created_at":"2026-01-15T08:58:55.3352104-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-5hv","title":"Short-circuit item lookup when visible results exist","description":"Avoid calling /items/lookup when the current DOM contains visible rows that match the search query. Only call lookup when no visible matches exist or when slot filters hide matches.","design":"Update frontend/static/js/search.js: add hasMatchingVisibleRow(query) that only considers visible rows (aria-hidden!='true'), short-circuit the fetch when matches exist, keep debounce and current UX; update tests and Playwright scenarios.","acceptance_criteria":"Given a search term that matches at least one visible row, When typing, Then the client does not issue a network request to /items/lookup and the search status remains unchanged.\n\nGiven a search term that matches no visible rows, When typing, Then the client issues a request to /items/lookup and shows suggestion/status messages per existing behavior.\n\nGiven a search term that would match rows hidden by slot filters, When typing, Then the client treats those as non-visible and calls lookup.","notes":"Files: frontend/static/js/search.js + related tests. Related: d3-item-salvager-9yd, d3-item-salvager-30t.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-13T21:35:21.0111565-05:00","created_by":"czer323","updated_at":"2026-01-13T21:35:21.0111565-05:00","labels":["ux"],"dependencies":[{"issue_id":"d3-item-salvager-5hv","depends_on_id":"d3-item-salvager-hbf","type":"blocks","created_at":"2026-01-13T22:09:13.5749343-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-6pj","title":"test","status":"closed","priority":2,"issue_type":"task","owner":"czer323@gmail.com","created_at":"2026-01-13T15:19:18.0862119-05:00","created_by":"czer323","updated_at":"2026-01-13T15:39:21.0743131-05:00","closed_at":"2026-01-13T15:39:21.0743131-05:00"}
{"id":"d3-item-salvager-7xk","title":"Research telemetry for items lookup frequency","description":"Research lightweight telemetry or server-side logging for /items/lookup call frequency to help measure potential optimization benefits and identify hotspots.","design":"Evaluate options: add server-side increment metric, log aggregation, or client event counter; propose minimal viable plan and estimate for full implementation.","acceptance_criteria":"Given the research completes, When reviewed, Then we have a recommended approach, tradeoffs, and an estimate for full implementation.","status":"open","priority":3,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":60,"created_at":"2026-01-13T21:35:44.9420479-05:00","created_by":"czer323","updated_at":"2026-01-13T21:35:44.9420479-05:00","labels":["research"],"dependencies":[{"issue_id":"d3-item-salvager-7xk","depends_on_id":"d3-item-salvager-1t2","type":"blocks","created_at":"2026-01-13T22:09:35.3048767-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-860","title":"Show item name with color indicating set vs legendary in item lists","description":"Display only the item name and visually distinguish set items (green) from regular legendary items (orange). Ensure backend includes quality in item payloads and frontend adds quality-based CSS classes; hide internal IDs like P4_Unique_* from visible labels.","design":"Backend: return item.quality in nested payloads. Frontend: add sanitized class quality-{value} to item name; map set-\u003egreen, legendary-\u003eorange; update templates and components; reuse existing tokens for colors.","acceptance_criteria":"Given an item with quality set, When the item list is rendered, Then the name element has class quality-set and appears green.\n\nGiven an item with quality legendary, When the item list is rendered, Then the name element has class quality-legendary and appears orange.\n\nGiven an item name containing internal ID suffixes (e.g., P4_Unique_*), When rendered, Then the visible label only shows the human-friendly name.","notes":"Implementation in branch feat/dev-stop-servers (PR #19: https://github.com/czer323/d3-item-salvager/pull/19). Changes: backend now includes `quality` in nested item payloads; frontend adds `quality-{value}` classes, sanitizes visible names, and applies text-color-only styles for set/legendary. Unit and integration tests updated and all tests pass locally. Ready for review and merge.","status":"in_review","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-13T20:47:43.3251807-05:00","created_by":"czer323","updated_at":"2026-01-15T16:21:04.7944505-05:00","labels":["ux"]}
{"id":"d3-item-salvager-9yd","title":"Remove Slot column and add colored usage chips in item lists","description":"Remove the visible Slot column from item usage tables but keep the data-item-slot attribute for filtering. Replace the per-row 'Used' badge and usage_label with per-context chips (Main, Follower, Kanai) using classes usage-main, usage-follower, usage-kanai.","design":"Update templates (frontend/templates/items/summary.html and frontend/templates/item_row.html) to render chips; update frontend/static/js/item_list.js for client-side rendering; add CSS classes in frontend/static/css/components.css and reuse accessible color tokens; ensure ARIA/accessibility.","acceptance_criteria":"Given the item usage table is rendered, When viewing rows, Then the Slot column is not visible but each row retains a data-item-slot attribute for filtering.\n\nGiven items have usage contexts, When rendered, Then each usage context is displayed as a chip with class usage-main, usage-follower or usage-kanai and readable text (Main / Follower / Kanai).\n\nGiven the item list is filtered by slot, When applying a slot filter, Then filtering still works using the preserved data-item-slot attribute.","notes":"Related issue: d3-item-salvager-860. Update unit and Playwright tests to cover behavior.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-13T21:08:35.5531657-05:00","created_by":"czer323","updated_at":"2026-01-13T21:10:18.3362249-05:00","labels":["ux"],"dependencies":[{"issue_id":"d3-item-salvager-9yd","depends_on_id":"d3-item-salvager-860","type":"related","created_at":"2026-01-15T04:56:40.160689-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-a7i","title":"Add usage-based filters (main / follower / kanai + optional class filter)","description":"Allow users to filter the item list by usage context (main, follower, kanai) and optionally by class when class usage metadata is available. The filter should work client-side using the existing ItemUsageTable rows (no extra backend requests for usage-type filtering).","design":"UI: add usage selector (toggle chips or checkboxes) to filter controls; extend FilterCriteria to include usage types and optional classes; apply client-side filtering via existing apply_filters pipeline so it composes with search \u0026 slot filters. Optional backend: expose usage_classes when available to enable class-based filtering. Persist filter state via query params for shareable URLs.","acceptance_criteria":"## Acceptance Criteria\n\n- Given items are loaded, When user selects a single usage type (e.g., Kanai), Then only items with that usage type appear without extra backend requests.\n- Given multiple usage types are selected, When applied, Then items matching any selected usage type are shown and other filters (search/slot) also apply.\n- Given class usage data is available, When user selects class filter(s), Then items used by those classes are shown (no network requests required for usage-type filter; class filter uses available data).","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-14T15:26:48.8155269-05:00","created_by":"czer323","updated_at":"2026-01-14T15:26:48.8155269-05:00","labels":["frontend","ux"]}
{"id":"d3-item-salvager-a7i.1","title":"Frontend: implement usage selector and client-side filtering","description":"Add usage UI controls in filter_controls, extend FilterCriteria to include usage_types and classes, update apply_filters() to filter rows by usage_contexts and usage_classes when present, and update templates/js to persist filter state in query parameters. Keep behavior compatible with existing search/slot filters and avoid extra backend calls for usage-only filters.","design":"Use toggle chips or checkboxes for Main/ Kanai/ Follower; when classes are available, show class multi-select. Ensure accessibility and add snapshots for visual checks.","acceptance_criteria":"## Acceptance Criteria\n\n- Given items loaded, When selecting Kanai usage, Then only Kanai items are visible without extra requests.\n- Given class usage data present, When selecting a class, Then results update to show items used by that class.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-14T15:27:04.3904997-05:00","created_by":"czer323","updated_at":"2026-01-14T15:27:04.3904997-05:00","labels":["frontend","ux"],"dependencies":[{"issue_id":"d3-item-salvager-a7i.1","depends_on_id":"d3-item-salvager-a7i","type":"parent-child","created_at":"2026-01-14T15:27:04.3927045-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-a7i.1","depends_on_id":"d3-item-salvager-ach","type":"related","created_at":"2026-01-14T15:27:54.3380237-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-a7i.2","title":"Tests: unit + Playwright for usage filter behavior","description":"Add unit tests covering FilterCriteria usage filters and apply_filters behavior; add Playwright tests for user interactions: toggle usage filters, combine with search/slot filters, and assert results. Include tests for class filter when class data is present and for query-param persistence.","design":"Unit: tests for fuzzy + usage filtering; Playwright: select usage chips and assert item list updates. Add fixtures for class usage scenarios.","acceptance_criteria":"## Acceptance Criteria\n\n- Given tests run, When usage filters are used, Then unit and Playwright tests assert correct filtering behavior and persistence.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-14T15:27:16.4467247-05:00","created_by":"czer323","updated_at":"2026-01-14T15:27:16.4467247-05:00","labels":["frontend","testing"],"dependencies":[{"issue_id":"d3-item-salvager-a7i.2","depends_on_id":"d3-item-salvager-a7i","type":"parent-child","created_at":"2026-01-14T15:27:16.4568479-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-a7i.3","title":"Docs: document usage-based filters and examples","description":"Document how to use the usage selector, query parameter format, and notes about class-filter availability and fallback. Provide example screenshots and Playwright guidance.","design":"Add docs in frontend/README or docs/ with screenshots and sample URLs.","acceptance_criteria":"## Acceptance Criteria\n\n- Given docs are updated, When developers and designers read them, Then they understand filter behavior, URL params, and how to test the feature.","status":"open","priority":3,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":60,"created_at":"2026-01-14T15:27:33.9916853-05:00","created_by":"czer323","updated_at":"2026-01-14T15:27:33.9916853-05:00","labels":["docs","frontend"],"dependencies":[{"issue_id":"d3-item-salvager-a7i.3","depends_on_id":"d3-item-salvager-a7i","type":"parent-child","created_at":"2026-01-14T15:27:33.9932654-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ach","title":"Class-colored usage chips: show which class uses each item","description":"Replace generic usage chips (main/follower/kanai) with per-class usage chips so users can see which class an item is used by. Support multiple classes per item with distinct colors for quick scanning.","design":"Backend: include profile class_name on item-usage responses so frontend knows which class each usage belongs to.\nFrontend: aggregate classes per item and render one chip per class; ensure de-duplication when multiple variants of the same class use the item.\nCSS: add color classes for each class (wizard, witch doctor, monk, demon hunter, barbarian, crusader) and normalize class names for CSS keys.\nTests: add backend integration tests for item-usage payloads and Playwright tests to assert multiple class chips render correctly.","acceptance_criteria":"## Acceptance Criteria\n\n- Given items used by selected builds for multiple classes, When the item list is rendered, Then one chip per class appears for that item, with the class name visible and the chip colored per the design (Wizard=Blue, Witch Doctor=Green, Monk=Orange, Demon Hunter=Purple, Barbarian=Red, Crusader=Yellow).\n\n- Given an item used by multiple variants of the same class, When the item list is rendered, Then only one chip for that class is present.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":300,"created_at":"2026-01-14T01:03:08.2393273-05:00","created_by":"czer323","updated_at":"2026-01-14T01:03:08.2393273-05:00","labels":["ux"],"dependencies":[{"issue_id":"d3-item-salvager-ach","depends_on_id":"d3-item-salvager-9yd","type":"related","created_at":"2026-01-15T05:04:22.8986063-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ach.1","title":"Backend: add profile class to item-usage responses","description":"Add profile class_name to each item usage row returned by /item-usage/{variant_id} so frontend can render class chips. Make field optional for compatibility.","design":"Add optional field profile_class_name to ItemUsageWithItemSchema. In list_item_usage_for_variant, fetch variant profile and include its class_name on each returned record. Add integration tests to assert the field is present with known variants.","acceptance_criteria":"## Acceptance Criteria\n\n- Given a variant id, When /item-usage/{variant_id} is requested, Then each entry includes profile_class_name matching the variant profile class.\n\n- Given no profile found, When /item-usage/{variant_id} is requested, Then profile_class_name is null or \"Unknown\" and endpoint still returns items.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-14T01:03:32.4393101-05:00","created_by":"czer323","updated_at":"2026-01-14T01:03:32.4393101-05:00","labels":["backend"],"dependencies":[{"issue_id":"d3-item-salvager-ach.1","depends_on_id":"d3-item-salvager-ach","type":"parent-child","created_at":"2026-01-14T01:03:32.4574842-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ach.2","title":"Frontend: aggregate classes per item and render class-colored chips","description":"Change frontend aggregation to capture class names per item and render one chip per class. Update templates (item_row.html) and client renderer (item_list.js) to show per-class chips and add appropriate aria attributes.","design":"Extend _UsageAccumulator to include classes:set[str]; update _collect_usage_for_builds and _merge_catalogue_with_usage to populate usage_classes on rows. Update server-rendered template and client renderer to emit class chips with normalized class-based CSS classes. Add unit tests for aggregation and template tests.","acceptance_criteria":"## Acceptance Criteria\n\n- Given usage rows include profile_class_name, When building the item table, Then each item row contains usage_classes listing distinct class names.\n\n- When rendered, Then there is one chip per class for items used by multiple classes and the chips have correct data-usage text.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-14T01:03:57.1983192-05:00","created_by":"czer323","updated_at":"2026-01-14T01:03:57.1983192-05:00","labels":["frontend"],"dependencies":[{"issue_id":"d3-item-salvager-ach.2","depends_on_id":"d3-item-salvager-ach","type":"parent-child","created_at":"2026-01-14T01:03:57.2003982-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-ach.2","depends_on_id":"d3-item-salvager-ach.1","type":"blocks","created_at":"2026-01-14T01:05:05.8635992-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ach.3","title":"Add CSS color tokens and styles for class usage chips","description":"Add CSS classes for class-colored usage chips and update component CSS. Ensure accessible contrast for colors and document classes mapping to colors: Wizard=Blue, Witch Doctor=Green, Monk=Orange, Demon Hunter=Purple, Barbarian=Red, Crusader=Yellow.","design":"Add classes like .usage-class-wizard, .usage-class-witch-doctor, etc. Keep .usage-chip base styles and add color overrides. Update styleguide/docs and run visual Playwright smoke tests.","acceptance_criteria":"## Acceptance Criteria\n\n- Given items render class chips, When viewing the UI, Then chips for each class show the specified color and remain readable with sufficient contrast.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":60,"created_at":"2026-01-14T01:04:21.577358-05:00","created_by":"czer323","updated_at":"2026-01-14T01:04:21.577358-05:00","labels":["ux"],"dependencies":[{"issue_id":"d3-item-salvager-ach.3","depends_on_id":"d3-item-salvager-ach","type":"parent-child","created_at":"2026-01-14T01:04:21.5830481-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ach.4","title":"Tests: unit and Playwright for class usage chips","description":"Add tests to assert class aggregation and rendering of class-colored chips. Unit: aggregator and template tests. Playwright: select multiple classes/builds where an item is used by multiple classes and assert chips and colors are present.","design":"Add unit tests for _collect_usage_for_builds and merge_catalogue_with_usage that include profile_class_name; update item_row template tests; add Playwright test to verify chips and colors.","acceptance_criteria":"## Acceptance Criteria\n\n- Given tests run, When an item is used by multiple classes, Then unit tests assert usage_classes includes each class and Playwright verifies displayed chips and colors.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-14T01:04:46.4869187-05:00","created_by":"czer323","updated_at":"2026-01-14T01:04:46.4869187-05:00","labels":["testing"],"dependencies":[{"issue_id":"d3-item-salvager-ach.4","depends_on_id":"d3-item-salvager-ach","type":"parent-child","created_at":"2026-01-14T01:04:46.4899658-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-ach.4","depends_on_id":"d3-item-salvager-ach.2","type":"blocks","created_at":"2026-01-14T01:05:24.5713518-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-be1","title":"Add docs: reset DB runbook and safety instructions","description":"Document the backup -\u003e cleanup -\u003e import workflow and safety precautions (do not run on production DB). Include example commands and explain how to recover from backups. Add entry to docs/ and README.md.","design":"Add docs/reset_local_db.md with step-by-step commands; add note to README about local DB cleanup; reference the reset script at scripts/reset_local_db.py and package entrypoint.","acceptance_criteria":"- [ ] docs/reset_local_db.md added with steps and examples.\n- [ ] README updated with link to runbook and warnings.\n- [ ] Issue d3-item-salvager-okk references the docs.","notes":"COMPLETED: Added  with step-by-step commands and safety guidance; updated  with link and safety note; referenced in related task notes. NEXT: None.","status":"closed","priority":2,"issue_type":"task","owner":"czer323@gmail.com","created_at":"2026-01-13T15:56:11.0300411-05:00","created_by":"czer323","updated_at":"2026-01-15T14:43:58.1381733-05:00","closed_at":"2026-01-15T14:43:58.1381733-05:00","close_reason":"Docs added and README updated; runbook available at docs/reset_local_db.md"}
{"id":"d3-item-salvager-bf5","title":"Load master item list into DB from reference/data.json","description":"Load items from reference/data.json into the Item DB table with idempotent upsert behavior so repeated runs do not fail on duplicates. Ensure items like Fleshrake and Blood Brother are present.\n\n## Acceptance Criteria\n\n- Given a fresh DB, when running the reference data loader, then the Item table contains Fleshrake and Blood Brother and total items \u003e 5000.\n- Given repeated runs, then the loader is idempotent and does not raise duplicate errors.","design":"Use DataParser.get_all_items and implement upsert logic in insert_items_from_dict or add a new upsert routine. Provide a CLI flag to control loading in reset_local_db. Add unit tests for idempotency.","notes":"Related: d3-item-salvager-5hv, d3-item-salvager-7xk","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-13T22:00:06.3566108-05:00","created_by":"czer323","updated_at":"2026-01-13T22:00:06.3566108-05:00","labels":["research"]}
{"id":"d3-item-salvager-cps","title":"Add tests and docs for master item list and lookup behavior","description":"Add unit, integration, and Playwright tests that verify Fleshrake and Blood Brother are found after loading master items; add docs describing how to refresh reference data and enabling frontend master-list validation.\n\n## Acceptance Criteria\n\n- Given the master list is loaded, when running tests, then unit and Playwright tests pass that assert local validation finds 'Fleshrake'.\n- Given documentation is present, when running reset_local_db, then developers can reload the master list using documented steps.","design":"Add tests to test_data_parser and search UI Playwright tests; update scripts/reset_local_db.py and docs/01 databaseImplementation.md; add example commands.","notes":"Related: d3-item-salvager-bf5, d3-item-salvager-hbf","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-13T22:00:49.3839734-05:00","created_by":"czer323","updated_at":"2026-01-13T22:00:49.3839734-05:00","labels":["testing"],"dependencies":[{"issue_id":"d3-item-salvager-cps","depends_on_id":"d3-item-salvager-bf5","type":"blocks","created_at":"2026-01-13T22:08:30.6351559-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-cps","depends_on_id":"d3-item-salvager-1t2","type":"blocks","created_at":"2026-01-13T22:08:45.2932718-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-cps","depends_on_id":"d3-item-salvager-hbf","type":"blocks","created_at":"2026-01-13T22:09:00.2216864-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-fwr","title":"Improve search ranking to prioritise exact and prefix matches over fuzzy subsequence matches","description":"Tighten search ranking so higher-probability results (exact and prefix matches) are ranked above fuzzy subsequence matches. Example: when typing 'ince', 'Incense Torch of the Grand Temple' should appear above unrelated subsequence matches.","design":"1) Audit current search implementation and scoring (client or server). 2) Implement ranking changes: boost exact and prefix matches, then token matches, then fuzzy subsequence matches. 3) Add unit tests for ranking behavior and integration/playwright test for the UI results. 4) Add optional telemetry to measure relevance improvements.","acceptance_criteria":"Given a user types a partial query such as \"ince\", When search runs, Then exact or prefix matches like \"Incense Torch of the Grand Temple\" should be ranked above other subsequence matches.\n\nGiven multiple matching items, When results are displayed, Then the top results are stable and clearly more relevant and fuzziness is only used as a fallback.","notes":"Related issues: d3-item-salvager-9yd, d3-item-salvager-860. Estimate covers research, implementation, tests, and small UI polish.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":360,"created_at":"2026-01-13T21:31:06.7394787-05:00","created_by":"czer323","updated_at":"2026-01-13T21:31:06.7394787-05:00","labels":["ux"]}
{"id":"d3-item-salvager-hbf","title":"Expose master item list to frontend for client-side validation","description":"Provide the master item name list to the frontend to allow client-side validation and autocomplete without extra backend calls. Consider embedding names in initial page render or providing a dedicated JSON endpoint (names only) with caching or lazy-load.\n\n## Acceptance Criteria\n\n- Given the page loads, when opening the search UI, then the client has the master name list and can validate 'Fleshrake' locally without calling /items/lookup.\n- Given large payload concerns, provide an opt-in config or lazy-load approach to avoid large initial page payloads.","design":"Implement endpoint or embed minimal compressed list (names/ids) and client caching; add tests (Playwright) to prove Fleshrake is validated locally; consider config to enable in prod.","notes":"Related: d3-item-salvager-bf5, d3-item-salvager-1t2","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-13T22:00:37.8157887-05:00","created_by":"czer323","updated_at":"2026-01-13T22:00:37.8157887-05:00","labels":["ux"],"dependencies":[{"issue_id":"d3-item-salvager-hbf","depends_on_id":"d3-item-salvager-bf5","type":"blocks","created_at":"2026-01-13T22:08:09.1379336-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-hbf","depends_on_id":"d3-item-salvager-1t2","type":"blocks","created_at":"2026-01-13T22:08:16.0367677-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-k9n","title":"Add tests asserting no lookup call when visible matches exist","description":"Add unit, integration, and Playwright tests that verify no /items/lookup network call is made when visible rows match the search query; ensure lookup is still performed when no visible matches exist.","design":"Unit: test hasMatchingVisibleRow behavior. Integration: simulate DOM and assert fetch is not called (mock). Playwright: intercept /items/lookup and assert no request is sent for visible matches, and assert request is sent when none exist.","acceptance_criteria":"Given the test suite runs, When the change is implemented, Then unit and integration tests verify the client avoids network lookup for visible matches and still calls lookup when no visible matches exist.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-13T21:35:26.5865435-05:00","created_by":"czer323","updated_at":"2026-01-13T21:35:26.5865435-05:00","labels":["testing"],"dependencies":[{"issue_id":"d3-item-salvager-k9n","depends_on_id":"d3-item-salvager-5hv","type":"blocks","created_at":"2026-01-13T22:09:28.0472499-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-n88","title":"Add mobile support (responsive, touch-friendly UI)","description":"Add first-class support for mobile devices: responsive layouts, touch-friendly controls, optimized performance, and accessible navigation. This epic covers auditing current UI, refactoring components for responsiveness, mobile navigation patterns, touch target sizing, performance profiling, and testing across devices.\n\n## Acceptance Criteria\n\n- Given the app is used on a mobile device, when navigating common flows, then layouts adapt to small screens, touch targets are usable, and performance is acceptable (reasonable load and interaction times).\n- Given mobile-first styles are enabled, when using touch interactions, then key flows (selection, apply, item inspection) work without layout shifts or hidden content.\n- Given accessibility checks run, when using assistive tech, then navigation and content remain usable on mobile devices.","design":"Audit current UI and list breakpoints and components needing work; refactor common components (filters, tables, modals) to be responsive and touch-friendly using Tailwind/DaisyUI patterns; implement mobile navigation (collapsible filters, mobile menu); add performance budgets and touch interaction tests (Playwright); update docs and style guide. Keep changes incremental and consider feature flags for rollout.","status":"open","priority":4,"issue_type":"epic","owner":"czer323@gmail.com","estimated_minutes":720,"created_at":"2026-01-14T01:42:22.9822362-05:00","created_by":"czer323","updated_at":"2026-01-14T01:42:22.9822362-05:00","labels":["mobile","ux"]}
{"id":"d3-item-salvager-n88.1","title":"Audit UI and accessibility for mobile readiness","description":"Perform a comprehensive audit of the current UI for mobile readiness: identify responsive breakpoints, components needing refactor (tables, filters, modals), touch-target sizes, and accessibility issues on small screens. Produce a prioritized remediation plan with recommended breakpoints and example CSS patterns using Tailwind/DaisyUI.","design":"Audit pages: selection/filters, item lists, detail views, modals, headers/menus. Record failing areas, reproduce with Playwright on mobile viewports, and produce a task list for fixes.","acceptance_criteria":"## Acceptance Criteria\n\n- Given the audit completes, When reviewed, Then we have a prioritized list of components and pages with suggested fixes and estimated effort for each.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-14T01:42:42.9866709-05:00","created_by":"czer323","updated_at":"2026-01-14T01:42:42.9866709-05:00","labels":["research","ux"],"dependencies":[{"issue_id":"d3-item-salvager-n88.1","depends_on_id":"d3-item-salvager-n88","type":"parent-child","created_at":"2026-01-14T01:42:42.9918279-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-n88.2","title":"Refactor core components for responsiveness (tables, filters, modals)","description":"Refactor the major UI components to be responsive and touch-friendly: item tables (stacked rows or virtual list for mobile), filter controls (collapsible/slide-over), and modals (full-screen on small devices). Use Tailwind/DaisyUI patterns and component props for mobile layouts.","design":"Make components accept responsive props, add mobile-specific variants and utilities, and ensure components degrade gracefully. Add snapshots or visual tests for key breakpoints.","acceptance_criteria":"## Acceptance Criteria\n\n- Given components are refactored, When viewing pages on small screens, Then layouts adapt (tables stack or use compact views), filters are accessible via a mobile pattern, and modals are usable full-screen.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":360,"created_at":"2026-01-14T01:43:01.4317289-05:00","created_by":"czer323","updated_at":"2026-01-14T01:43:01.4317289-05:00","labels":["frontend","ux"],"dependencies":[{"issue_id":"d3-item-salvager-n88.2","depends_on_id":"d3-item-salvager-n88","type":"parent-child","created_at":"2026-01-14T01:43:01.4332882-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-n88.2","depends_on_id":"d3-item-salvager-n88.1","type":"blocks","created_at":"2026-01-14T01:44:14.4586355-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-n88.3","title":"Implement mobile navigation patterns and touch-friendly controls","description":"Add mobile navigation patterns: collapsible filters, a mobile menu, and adaptable headers. Improve touch-friendly controls and gestures where appropriate (e.g., swipe to dismiss). Ensure keyboard accessibility remains intact.","design":"Introduce mobile menu / slide-over for navigation and filters; implement touch gesture handling carefully; add visual indicators and accessible labels.","acceptance_criteria":"## Acceptance Criteria\n\n- Given mobile navigation is implemented, When using the app on a phone, Then filtering, choosing builds, and navigation are discoverable and usable without desktop-style controls.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-14T01:43:17.1424188-05:00","created_by":"czer323","updated_at":"2026-01-14T01:43:17.1424188-05:00","labels":["frontend","ux"],"dependencies":[{"issue_id":"d3-item-salvager-n88.3","depends_on_id":"d3-item-salvager-n88","type":"parent-child","created_at":"2026-01-14T01:43:17.1450944-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-n88.3","depends_on_id":"d3-item-salvager-n88.2","type":"blocks","created_at":"2026-01-14T01:44:28.9032751-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-n88.4","title":"Mobile performance budgets and profiling","description":"Define mobile performance budgets (Time to Interactive, first paint, size) and profile app behavior on mobile viewports. Implement optimizations (bundle splits, lazy-load, image optimizations) as recommended by profiling.","design":"Run Lighthouse and Playwright metrics on representative pages; propose prioritized optimizations; implement quick wins and measure improvement.","acceptance_criteria":"## Acceptance Criteria\n\n- Given profiling runs, When recommendations are applied, Then key metrics (TTI, FCP) show measurable improvement and fall within defined budgets for mobile devices.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-14T01:43:45.7544772-05:00","created_by":"czer323","updated_at":"2026-01-14T01:43:45.7544772-05:00","labels":["performance","ux"],"dependencies":[{"issue_id":"d3-item-salvager-n88.4","depends_on_id":"d3-item-salvager-n88","type":"parent-child","created_at":"2026-01-14T01:43:45.7560919-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-n88.4","depends_on_id":"d3-item-salvager-n88.1","type":"blocks","created_at":"2026-01-14T01:44:42.0936731-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-n88.5","title":"Add mobile e2e and accessibility tests + docs","description":"Add Playwright e2e tests for representative mobile flows and integrate accessibility checks (axe). Update docs with mobile usage guidance and style guide entries for responsive components.","design":"Create Playwright tests using mobile viewports to test selection, apply, filtering, and item details; run axe checks; update docs and testing guidance.","acceptance_criteria":"## Acceptance Criteria\n\n- Given tests run in CI, When changes are made, Then mobile Playwright tests and accessibility checks pass and docs describe mobile usage patterns.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-14T01:44:01.3751858-05:00","created_by":"czer323","updated_at":"2026-01-14T01:44:01.3751858-05:00","labels":["docs","testing"],"dependencies":[{"issue_id":"d3-item-salvager-n88.5","depends_on_id":"d3-item-salvager-n88","type":"parent-child","created_at":"2026-01-14T01:44:01.3767398-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-n88.5","depends_on_id":"d3-item-salvager-n88.2","type":"blocks","created_at":"2026-01-14T01:44:56.0567498-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-okk","title":"Fix: local DB corrupted â€” mixed class items in builds; remove \u0026 repopulate builds","description":"Problem: Local development DB contains corrupted build data: different class items are appended into other builds, causing test failures and unreliable imports. Default DB: d3_items.db. Importers found: python -m d3_item_salvager.scripts.import_guides and python -m d3_item_salvager.utility.load_reference_data. Note: Alembic migrations are not present in repo (migration risk).\n\n## Steps to Reproduce\n1. Run python -m d3_item_salvager.scripts.import_guides against local DB (d3_items.db).\n2. Query builds and related items using sqlite3 or a Python session and look for items attached to unexpected builds.\n3. Observe cross-class mixing: items with different class IDs attached to the same build.","design":"Backup DB; validate cleanup on a copy; recommended: drop and recreate schema using SQLModel.metadata.drop_all/create_all via Container engine; alternative: granular DELETEs in FK-safe order. Repopulate using importer scripts and add an automated script to run backup -\u003e cleanup -\u003e import.","acceptance_criteria":"## Acceptance Criteria\n- [ ] Backup file created (d3_items.db.bak) and SQL dump saved.\n- [ ] Cleanup + import executed successfully with the recommended script.\n- [ ] Builds table contains only imported builds and no cross-class mixing.\n- [ ] Integration tests pass: pytest tests/integration/test_builds_items.py","notes":"WORK COMPLETE (local): Ran reset script and verified integration tests. REFERENCE: Docs runbook added at docs/reset_local_db.md with usage and safety guidance. NEXT: None.","status":"closed","priority":1,"issue_type":"bug","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-13T15:36:31.5075701-05:00","created_by":"czer323","updated_at":"2026-01-15T14:44:05.9522174-05:00","closed_at":"2026-01-15T06:21:28.5431578-05:00","labels":["testing","tooling"]}
{"id":"d3-item-salvager-okk.1","title":"Implement reset \u0026 repopulation script (local dev)","description":"Create  to back up DB (copy + dump), perform safe cleanup (drop/create or granular delete), and run importers to repopulate. Must support , , , and  flags and log actions. Tests and docs required.","design":"Use Container().engine() for engine; use SQLModel.metadata.drop_all/create_all; call importers  and ; ensure script refuses to run against non-dev DBs unless explicit flag set.","acceptance_criteria":"- [ ] Script exists at  and supports flags.\n- [ ] Backup created and SQL dump saved.\n- [ ] Running script on test copy recreates schema and imports builds without cross-class mixing.\n- [ ] Integration tests added and passing.","notes":"Implemented reset script and integration tests; ran the script against local DB with confirm: backups created at backups/d3_items.db.bak and SQL dump at backups/d3_items.db.sql. Integration tests (including tests/integration/test_builds_items.py) pass locally. No commits pushed; preparing PR after your review.","status":"closed","priority":1,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-13T15:44:17.2263834-05:00","created_by":"czer323","updated_at":"2026-01-13T15:55:49.3291616-05:00","closed_at":"2026-01-13T15:55:49.3291616-05:00","labels":["testing","tooling"],"dependencies":[{"issue_id":"d3-item-salvager-okk.1","depends_on_id":"d3-item-salvager-okk","type":"parent-child","created_at":"2026-01-13T15:44:17.2376795-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ply","title":"Add DB migrations (Alembic) and migration workflow","description":"Repository currently lacks Alembic migrations; add Alembic (or compatible migration tool), generate initial migrations from current models, and add CI/automation to ensure schema migrations are applied and tested.","design":"Add Alembic to repo; configure env and alembic.ini to target development DATABASE_URL; autogenerate initial migration from SQLModel metadata; add migration test that creates a fresh DB, runs alembic upgrade head, and verifies expected tables exist; add a reset script and docs.","acceptance_criteria":"## Acceptance Criteria\n- [ ] Alembic or compatible migrations added to repo and checked into source control.\n- [ ] Running alembic upgrade head on a fresh DB produces the expected tables (matches models).\n- [ ] CI includes a migration test that runs migrations against a fresh DB and validates schema.\n- [ ] A documented reset script exists for local dev that recreates the DB and imports reference data.","notes":"COMPLETED: Added Alembic (config + env), initial migration, migration helper (), integration migration test, and updated  to support  with a robust fallback; added runbook  documenting destructive reset vs in-place migrations. PR #16 merged into main. Branch protection updated to allow admin self-approvals (required_approving_review_count set to 0).\\nIN PROGRESS: None.\\nNEXT: None.\\nKEY_DECISION: Reset is destructive (drop + repopulate). For preserving data use in-place  with data migrations as needed.","status":"closed","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-13T15:36:53.3865052-05:00","created_by":"czer323","updated_at":"2026-01-15T14:40:22.5504217-05:00","closed_at":"2026-01-15T14:40:22.5504217-05:00","close_reason":"Implemented Alembic migrations, tests, reset docs; PR #16 merged; branch protection updated","labels":["tooling"],"dependencies":[{"issue_id":"d3-item-salvager-ply","depends_on_id":"d3-item-salvager-okk","type":"discovered-from","created_at":"2026-01-13T15:36:53.3923617-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ucb","title":"Show selected builds for an item (expandable item row)","description":"Allow users to expand an item row to see which of the currently selected builds include that item (build-level, not variant). The expansion shows build title (linked to source), class chips, and an optional usage_count. Only builds the user previously selected should be considered.\n\n## Acceptance Criteria\n\n- Given selected builds are present, When the user expands an item, Then only the selected builds that include that item are listed, each with title, URL, class chips, and usage_count.\n- Given no selected builds are provided, When the user expands an item, Then a friendly message is shown (e.g., 'No selected builds use this item').","design":"Backend: add GET /items/{item_id}/builds?build_ids=... which filters to provided build IDs and returns aggregated class names and usage counts per build. Frontend: add an accessible expand/collapse control per item row that lazy-loads the builds for that item (passing current selected build ids), caches results, and renders build title (link), class chips, and count. Tests: integration test for endpoint, Playwright test for expand behavior and accessibility. Docs: add usage notes and API docs.","status":"open","priority":4,"issue_type":"epic","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-14T02:40:52.0499829-05:00","created_by":"czer323","updated_at":"2026-01-14T02:40:52.0499829-05:00","labels":["ux"]}
{"id":"d3-item-salvager-ucb.1","title":"Backend: GET /items/{item_id}/builds (filter by selected build_ids)","description":"Add endpoint that returns builds (limited to provided build_ids) which include the specified item. Response fields: build_id, title, url, class_names (distinct), usage_count. Support pagination and return empty list when build_ids omitted or none selected.","design":"Query ItemUsage -\u003e Profile -\u003e Build and group by Build.id, aggregate distinct classes and count of usages. Add integration tests and error handling for bad build_ids.","acceptance_criteria":"## Acceptance Criteria\n\n- Given build_ids and item_id, When GET /items/{item_id}/builds is called, Then the response lists only the builds in build_ids that include the item and includes class_names and usage_count per build.\n\n- Given no build_ids provided, When GET /items/{item_id}/builds is called, Then the response is an empty list and HTTP 200.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-14T02:41:08.1888063-05:00","created_by":"czer323","updated_at":"2026-01-14T02:41:08.1888063-05:00","labels":["backend"],"dependencies":[{"issue_id":"d3-item-salvager-ucb.1","depends_on_id":"d3-item-salvager-ucb","type":"parent-child","created_at":"2026-01-14T02:41:08.2016456-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ucb.2","title":"Frontend: expand item row to show selected builds","description":"Add an expand/collapse control per item row that fetches GET /items/{item_id}/builds?build_ids=... to render the selected builds that include the item. Show build title (link), class chips, and usage_count. Cache results client-side and make the control accessible.","design":"Add button with aria-expanded and aria-controls. Render collapsible panel beneath the item row with a compact list. Use client-side fetch in item_list.js and template partial for markup. Handle empty selected builds gracefully.","acceptance_criteria":"## Acceptance Criteria\n\n- Given the user selected builds then clicks Expand on an item, When the endpoint returns matching builds, Then the UI displays only those selected builds with title, URL, class chips, and counts.\n- Given the user clicks Expand again, When the panel is open, Then it collapses without a new network request (cached rendering).","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":240,"created_at":"2026-01-14T02:41:23.8452271-05:00","created_by":"czer323","updated_at":"2026-01-14T02:41:23.8452271-05:00","labels":["frontend","ux"],"dependencies":[{"issue_id":"d3-item-salvager-ucb.2","depends_on_id":"d3-item-salvager-ucb","type":"parent-child","created_at":"2026-01-14T02:41:23.8474017-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-ucb.2","depends_on_id":"d3-item-salvager-ucb.1","type":"blocks","created_at":"2026-01-14T02:41:50.8869479-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-ucb.2","depends_on_id":"d3-item-salvager-ach","type":"blocks","created_at":"2026-01-14T02:42:02.9004036-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ucb.3","title":"Tests: unit/integration/Playwright for item-\u003eselected-builds expansion","description":"Add backend integration tests for GET /items/{item_id}/builds and Playwright tests for expand behavior: select builds, expand an item used by multiple selected builds, assert listed builds match selection and show title+link+class chips+count. Add unit tests for client caching and empty selected-build handling.","design":"Backend integration: create sample builds/profiles/usages and assert response. Playwright: intercept endpoint and assert UI behavior and accessibility.","acceptance_criteria":"## Acceptance Criteria\n\n- Given tests run, When an item is expanded with selected builds, Then integration tests assert endpoint correctness and Playwright asserts the UI displays selected builds only with correct elements.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-14T02:41:39.0201105-05:00","created_by":"czer323","updated_at":"2026-01-14T02:41:39.0201105-05:00","labels":["testing"],"dependencies":[{"issue_id":"d3-item-salvager-ucb.3","depends_on_id":"d3-item-salvager-ucb","type":"parent-child","created_at":"2026-01-14T02:41:39.0217033-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-ucb.3","depends_on_id":"d3-item-salvager-ucb.2","type":"blocks","created_at":"2026-01-14T02:42:15.2077795-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ucb.4","title":"Docs: document item -\u003e selected builds expand behaviour","description":"Add docs for the item expansion feature: API docs for GET /items/{item_id}/builds, frontend behavior, and UX notes (selection-limited scope). Include sample payload and usage examples.","design":"Document API, sample responses, UI screenshots, accessibility notes, and testing guidance.","acceptance_criteria":"## Acceptance Criteria\n\n- Given docs are reviewed, When developers read them, Then they understand how to call the API, expected response shape, UI behavior, and how to test/verify the expansion.","status":"open","priority":3,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":60,"created_at":"2026-01-14T02:42:31.9530719-05:00","created_by":"czer323","updated_at":"2026-01-14T02:42:31.9530719-05:00","labels":["docs"],"dependencies":[{"issue_id":"d3-item-salvager-ucb.4","depends_on_id":"d3-item-salvager-ucb","type":"parent-child","created_at":"2026-01-14T02:42:31.9600889-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ut7","title":"Prefer variants section when extracting planner IDs from guide pages","description":"Current planner ID extraction scans the whole guide HTML and sometimes picks planner IDs not present under the Variants area (e.g., altar or other embedded planners). Update the parser to prefer planner IDs found inside the Variants section (e.g., the tabsV2 block near id='variants-header') and fall back to the global search when no variant section is present.","design":"1) Locate the Variants heading (id='variants' or id='variants-header' or heading text 'Variants'). 2) Extract the HTML subtree for that section (up to next H2 or a safe offset) and search for data-d3planner-id and /d3planner/ links there. 3) Apply existing blacklist/type filters (e.g., altar) and deduplicate. 4) If no IDs found in Variants area, fallback to current global scanning logic. 5) Add robust unit/integration tests and sample HTML fixtures.","acceptance_criteria":"## Acceptance Criteria\n\n- Given guide HTML that includes planner IDs only in the Variants tabsV2 block, When extracting planner IDs, Then the resolver returns those IDs and skips planner IDs elsewhere on the page.\n\n- Given guide HTML with no Variants block, When extracting planner IDs, Then the resolver falls back to the original global search and returns planner IDs from the page as before.\n\n- All new behavior is covered by unit and integration tests.","status":"open","priority":2,"issue_type":"bug","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-14T15:22:47.0458796-05:00","created_by":"czer323","updated_at":"2026-01-14T15:22:47.0458796-05:00","labels":["backend","bug","parsing"]}
{"id":"d3-item-salvager-ut7.1","title":"Implement parser: prefer Variants block for planner ID extraction","description":"Modify GuideProfileResolver._extract_planner_ids to first search the Variants section (id='variants' or 'variants-header' or heading text) and extract planner IDs from that subtree. Keep blacklist filtering for altar/planner-type and deduplicate. Add helper method extract_ids_from_html_subtree for unit testing.","design":"Search for variants heading, find end of section (next \u003ch2\u003e or safe offset), extract substring, run existing detection (data-d3planner-id, /d3planner/ regex) on the substring; return results if found, else run global fallback. Add unit tests for helper and integration tests.","acceptance_criteria":"## Acceptance Criteria\n\n- Given guide HTML containing planner ids in the Variants subtree, When _extract_planner_ids runs, Then it returns only those ids.\n- Given no ids in Variants subtree, When _extract_planner_ids runs, Then the original fallback behavior applies and returns ids discovered globally.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-14T15:23:12.5520071-05:00","created_by":"czer323","updated_at":"2026-01-14T15:23:12.5520071-05:00","labels":["backend","parsing"],"dependencies":[{"issue_id":"d3-item-salvager-ut7.1","depends_on_id":"d3-item-salvager-ut7","type":"parent-child","created_at":"2026-01-14T15:23:12.5616025-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ut7.2","title":"Tests: unit/integration for variants-area planner ID extraction","description":"Add unit tests for the helper extract_ids_from_html_subtree using sample HTML snippets (including the tabsV2 variants block). Add integration tests for _extract_planner_ids using full guide HTML fixtures (from reference/). Ensure coverage for fallback and blacklist behavior.","design":"Create fixtures in tests/reference/ with samples: 'variants-block-with-planner-ids.html', 'planner-ids-outside-variants.html', 'no-variants-fallback.html'. Add tests asserting returned ids and ordering/deduping.","acceptance_criteria":"## Acceptance Criteria\n\n- Given fixture with planner ids in variants block, When running tests, Then the helper and upstream method return only those ids.\n- Given fixture without variants, When running tests, Then fallback returns globally discovered ids.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":90,"created_at":"2026-01-14T15:23:28.2500727-05:00","created_by":"czer323","updated_at":"2026-01-14T15:23:28.2500727-05:00","labels":["backend","testing"],"dependencies":[{"issue_id":"d3-item-salvager-ut7.2","depends_on_id":"d3-item-salvager-ut7","type":"parent-child","created_at":"2026-01-14T15:23:28.2516705-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-ut7.2","depends_on_id":"d3-item-salvager-ut7.1","type":"blocks","created_at":"2026-01-14T15:23:53.2759727-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-ut7.3","title":"Docs: document variant-focused planner ID extraction and add fixtures","description":"Document the new parser behavior, why we prefer the Variants subtree, and include sample fixtures and notes for future maintainers. Add the HTML fixtures to tests/reference/ and document how to update tests if Maxroll changes markup.","design":"Add README note, sample fixture files, and update developer docs referencing the new helper function and tests.","acceptance_criteria":"## Acceptance Criteria\n\n- Given docs are updated, When a developer reads them, Then they understand the new heuristic and where to find fixtures and tests to update when Maxroll markup changes.","status":"open","priority":3,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":30,"created_at":"2026-01-14T15:23:42.0961585-05:00","created_by":"czer323","updated_at":"2026-01-14T15:23:42.0961585-05:00","labels":["backend","docs"],"dependencies":[{"issue_id":"d3-item-salvager-ut7.3","depends_on_id":"d3-item-salvager-ut7","type":"parent-child","created_at":"2026-01-14T15:23:42.1057743-05:00","created_by":"czer323"},{"issue_id":"d3-item-salvager-ut7.3","depends_on_id":"d3-item-salvager-ut7.1","type":"blocks","created_at":"2026-01-14T15:24:06.1522556-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-wou","title":"Apply filter triggers double load/render (UX bug)","description":"Clicking the Apply filter button triggers both a client-side fetch (item_list.js) and an HTMX form submission that swaps the same item summary area, resulting in two renders and a visible flicker. The UI should update only once per user action.","design":"Investigate current event flow (client-side click handler in item_list.js, HTMX form submit in selection form). Implement coordination so only one rendering path updates the table per Apply interaction (options: detect HTMX and skip client fetch; use a pending flag; or centralize rendering to HTMX). Ensure fallback when HTMX is not available.","acceptance_criteria":"Given the user clicks Apply, When the selection is submitted, Then only one network request/render occurs and the item table updates exactly once.\n\nGiven HTMX is not present, When the user clicks Apply, Then the client-side fetch path should continue to work and update the table once.","status":"open","priority":2,"issue_type":"bug","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-13T22:20:03.7928906-05:00","created_by":"czer323","updated_at":"2026-01-13T22:20:03.7928906-05:00","labels":["ux"]}
{"id":"d3-item-salvager-wou.1","title":"Investigate double-render flow for Apply (spike)","description":"Trace and document the exact sequence when Apply is clicked: user click, HTMX form submit and swap, item_list.js click handler fetch, and filtering.triggerApply interactions; capture reproduction steps, logs, and suggested fixes (A/B/C).","design":"Instrument event handlers and intercept /builds/items and HTMX calls in Playwright; produce a short recommendation with preferred fix and estimated effort.","acceptance_criteria":"Given the investigation completes, When reviewed, Then we have a clear root cause, reproduction steps, and a recommended fix option with effort estimate.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":90,"created_at":"2026-01-13T22:20:11.0309683-05:00","created_by":"czer323","updated_at":"2026-01-13T22:20:11.0309683-05:00","labels":["research"],"dependencies":[{"issue_id":"d3-item-salvager-wou.1","depends_on_id":"d3-item-salvager-wou","type":"parent-child","created_at":"2026-01-13T22:20:11.0421804-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-wou.2","title":"Implement fix to ensure single render on Apply","description":"Implement coordination so Apply triggers exactly one load/render. Preferred minimal approach: detect HTMX form-submit and skip the client-side fetch in item_list.js; alternative option: use a central pending flag to coordinate programmatic triggers. Include necessary feature toggles to preserve behavior when HTMX unavailable.","design":"Modify item_list.js to short-circuit when HTMX/selection form is present or when pending flag set; add htmx hooks to clear flags. Add unit tests and Playwright tests to assert single render.","acceptance_criteria":"Given the fix is implemented, When clicking Apply, Then only one request/render occurs and the UI updates once; tests verify single-request behavior.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":180,"created_at":"2026-01-13T22:20:18.5249166-05:00","created_by":"czer323","updated_at":"2026-01-13T22:20:18.5249166-05:00","labels":["ux"],"dependencies":[{"issue_id":"d3-item-salvager-wou.2","depends_on_id":"d3-item-salvager-wou","type":"parent-child","created_at":"2026-01-13T22:20:18.5350713-05:00","created_by":"czer323"}]}
{"id":"d3-item-salvager-wou.3","title":"Add tests ensuring single render on Apply and no flicker","description":"Add Playwright + unit tests that confirm only one network request is made on Apply and the table updates once (no client-side transient flash followed by server swap). Tests should cover user click and programmatic triggerApply() flows.","design":"Playwright: intercept /builds/items and HTMX swap, click apply and assert only one request and final DOM state. Unit: mock item_list.js handler to assert early exit when HTMX present.","acceptance_criteria":"Given tests run, When Apply is clicked, Then only one request occurs and no intermediate flicker happens, and tests assert this across contexts.","status":"open","priority":2,"issue_type":"task","owner":"czer323@gmail.com","estimated_minutes":120,"created_at":"2026-01-13T22:20:25.2678323-05:00","created_by":"czer323","updated_at":"2026-01-13T22:20:25.2678323-05:00","labels":["testing"],"dependencies":[{"issue_id":"d3-item-salvager-wou.3","depends_on_id":"d3-item-salvager-wou","type":"parent-child","created_at":"2026-01-13T22:20:25.2790424-05:00","created_by":"czer323"}]}
